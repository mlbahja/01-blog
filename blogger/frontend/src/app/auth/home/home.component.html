<!-- Navigation Header -->
<header class="site-header">
  <div class="header-container">
    <div class="logo">
      <h1>My Blog</h1>
    </div>
    <nav class="main-nav">
      <a href="#" class="nav-link active">Home</a>
      <a href="#" class="nav-link">Categories</a>
      <a href="#" class="nav-link">About</a>
      <a href="#" class="nav-link">Contact</a>
    </nav>
    <div class="header-actions">
      <span class="user-greeting">Hello, {{ username }}</span>
      <button class="logout-button" (click)="logout()">Logout</button>
    </div>
  </div>
</header>

<!-- Main Content -->
<main class="main-content">
  <div class="container">
    <!-- Create Post Section -->
    <section class="create-post-section" *ngIf="showCreateForm">
      <div class="section-header">
        <h2 class="section-title">Share Your Story</h2>
        <button class="close-form-btn" (click)="showCreateForm = false">&times;</button>
      </div>
      <form class="post-form" (ngSubmit)="createPost()">
        <div class="form-group">
          <input
            type="text"
            [(ngModel)]="newPost.title"
            name="title"
            placeholder="Enter your post title..."
            class="form-input title-input"
            required
          />
        </div>
        <div class="form-group">
          <textarea
            [(ngModel)]="newPost.content"
            name="content"
            placeholder="Tell your story..."
            class="form-textarea"
            rows="6"
            required
          ></textarea>
        </div>
        <div class="form-actions">
          <button type="submit" class="btn btn-primary">Publish Post</button>
          <button type="button" class="btn btn-secondary" (click)="showCreateForm = false">Cancel</button>
        </div>
      </form>
    </section>

    <!-- Floating Create Button -->
    <button class="floating-create-btn" *ngIf="!showCreateForm" (click)="showCreateForm = true">
      <span class="plus-icon">+</span> New Post
    </button>

    <!-- Featured Post (if available) -->
    <section class="featured-section" *ngIf="posts.length > 0">
      <article class="featured-post">
        <div class="featured-content">
          <span class="featured-label">Featured Story</span>
          <h2 class="featured-title">{{ posts[0].title }}</h2>
          <p class="featured-excerpt">{{ posts[0].content | slice:0:200 }}{{ posts[0].content.length > 200 ? '...' : '' }}</p>
          <div class="post-meta">
            <span class="author">By {{ posts[0].author }}</span>
            <span class="separator">‚Ä¢</span>
            <span class="date">{{ posts[0].createdAt | date:'MMM d, yyyy' }}</span>
            <span class="separator" *ngIf="posts[0].comments">‚Ä¢</span>
            <span class="comments-count" *ngIf="posts[0].comments">{{ posts[0].comments.length }} Comments</span>
            <span class="separator">‚Ä¢</span>
            <button class="like-btn" (click)="toggleLike(posts[0])" [class.liked]="posts[0].isLiked">
              <span class="like-icon">{{ posts[0].isLiked ? '‚ù§Ô∏è' : 'ü§ç' }}</span>
              <span class="like-count">{{ posts[0].likeCount || 0 }}</span>
            </button>
          </div>
        </div>
      </article>
    </section>

    <!-- Blog Posts Grid -->
    <section class="posts-section">
      <h2 class="section-title">Recent Stories</h2>
      <div class="posts-grid">
        <article class="post-card" *ngFor="let post of posts.slice(1); let i = index">
          <div class="post-card-content">
            <h3 class="post-card-title">{{ post.title }}</h3>
            <p class="post-card-excerpt">{{ post.content | slice:0:150 }}{{ post.content.length > 150 ? '...' : '' }}</p>
            <div class="post-card-meta">
              <span class="author">{{ post.author }}</span>
              <span class="separator">‚Ä¢</span>
              <span class="date">{{ post.createdAt | date:'MMM d' }}</span>
              <span class="separator">‚Ä¢</span>
              <button class="like-btn" (click)="toggleLike(post)" [class.liked]="post.isLiked">
                <span class="like-icon">{{ post.isLiked ? '‚ù§Ô∏è' : 'ü§ç' }}</span>
                <span class="like-count">{{ post.likeCount || 0 }}</span>
              </button>
            </div>
            <button class="read-more-btn" (click)="expandPost(i + 1)">
              {{ expandedPosts.has(i + 1) ? 'Show Less' : 'Read More' }}
            </button>
          </div>

          <!-- Expanded Post Content -->
          <div class="post-expanded" *ngIf="expandedPosts.has(i + 1)">
            <div class="post-full-content">
              <p>{{ post.content }}</p>
            </div>

            <!-- Comments Section -->
            <div class="comments-section">
              <h4 class="comments-title">Comments ({{ post.comments?.length || 0 }})</h4>
              <div class="comments-list" *ngIf="post.comments && post.comments.length > 0">
                <div class="comment" *ngFor="let comment of post.comments">
                  <div class="comment-header">
                    <span class="comment-author">{{ comment.author }}</span>
                    <span class="comment-date">{{ comment.createdAt | date:'MMM d, yyyy' }}</span>
                  </div>
                  <p class="comment-text">{{ comment.content }}</p>
                </div>
              </div>
              <div class="no-comments" *ngIf="!post.comments || post.comments.length === 0">
                <p>Be the first to comment on this post.</p>
              </div>

              <!-- Add Comment Form -->
              <form class="comment-form" (ngSubmit)="addComment(post.id, commentText.value); commentText.value = ''">
                <div class="comment-input-wrapper">
                  <input
                    #commentText
                    type="text"
                    placeholder="Share your thoughts..."
                    class="comment-input"
                    required
                  />
                  <button type="submit" class="comment-submit-btn">Post Comment</button>
                </div>
              </form>
            </div>
          </div>
        </article>
      </div>

      <!-- Empty State -->
      <div class="empty-state" *ngIf="posts.length === 0">
        <div class="empty-state-content">
          <h3>No posts yet</h3>
          <p>Be the first to share your story!</p>
          <button class="btn btn-primary" (click)="showCreateForm = true">Create Your First Post</button>
        </div>
      </div>
    </section>
  </div>
</main>

<!-- Footer -->
<footer class="site-footer">
  <div class="container">
    <p>&copy; 2025 My Blog. All rights reserved.</p>
  </div>
</footer>
